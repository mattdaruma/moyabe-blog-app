<div [hidden]="
    !settings?.displayViewOptions && 
    !settings?.displaySortOptions &&
    !settings?.displayFilterOptions && 
    !settings?.displayAuthorOptions && 
    !settings?.displayTagOptions && 
    !settings?.displayResetButtons
    ">
    <div [formGroup]="settingsForm" class="settings-form top-pad" >
        <div formGroupName="display" class="settings-row" *ngIf="settings?.displayViewOptions === true">
            <span>
                <mat-label>Feed View </mat-label>
                <mat-button-toggle-group color="primary" #feedview="matButtonToggleGroup" formControlName="feed">
                    <mat-button-toggle color="primary" value="grid"><mat-icon>grid_view</mat-icon></mat-button-toggle>
                    <mat-button-toggle value="list"><mat-icon>view_list</mat-icon></mat-button-toggle>
                </mat-button-toggle-group>
            </span>
            <span>
                <mat-label>Fields Displayed </mat-label>
                <mat-button-toggle-group color="primary" multiple formControlName="fields">
                    <mat-button-toggle value="postId">ID</mat-button-toggle>
                    <mat-button-toggle value="title">Title</mat-button-toggle>
                    <mat-button-toggle value="cover">Cover</mat-button-toggle>
                    <mat-button-toggle value="addedDate">Date</mat-button-toggle>
                    <mat-button-toggle value="description">Description</mat-button-toggle>
                    <mat-button-toggle value="author">Author</mat-button-toggle>
                    <mat-button-toggle value="tags">Tags</mat-button-toggle>
                    <mat-button-toggle value="link">Link</mat-button-toggle>
                </mat-button-toggle-group>
            </span>
        </div>
        <div class="settings-row" *ngIf="settings?.displaySortOptions === true">
            <span>
                <mat-label>Date Sort </mat-label>
                <mat-button-toggle-group [value]="settings?.sortDate" color="primary"> 
                    <mat-button-toggle (click)="selectSort('date', 1)" [value]="1"><mat-icon>arrow_upward</mat-icon></mat-button-toggle>
                    <mat-button-toggle (click)="selectSort('date', -1)" [value]="-1"><mat-icon>arrow_downward</mat-icon></mat-button-toggle>
                    <mat-button-toggle (click)="selectSort('date', 0)" [value]="0"><mat-icon>block</mat-icon></mat-button-toggle>
                </mat-button-toggle-group>
            </span>
            <span>
                <mat-label>Title Sort </mat-label>
                <mat-button-toggle-group [value]="settings?.sortTitle" color="primary" >
                    <mat-button-toggle (click)="selectSort('title', 1)" [value]="1"><mat-icon>arrow_upward</mat-icon></mat-button-toggle>
                    <mat-button-toggle (click)="selectSort('title', -1)" [value]="-1"><mat-icon>arrow_downward</mat-icon></mat-button-toggle>
                    <mat-button-toggle (click)="selectSort('title', 0)" [value]="0"><mat-icon>block</mat-icon></mat-button-toggle>
                </mat-button-toggle-group>
            </span>
            <span>
                <mat-label>Author Sort </mat-label>
                <mat-button-toggle-group [value]="settings?.sortAuthor" color="primary" >
                    <mat-button-toggle (click)="selectSort('author', 1)" [value]="1"><mat-icon>arrow_upward</mat-icon></mat-button-toggle>
                    <mat-button-toggle (click)="selectSort('author', -1)" [value]="-1"><mat-icon>arrow_downward</mat-icon></mat-button-toggle>
                    <mat-button-toggle (click)="selectSort('author', 0)" [value]="0"><mat-icon>block</mat-icon></mat-button-toggle>
                </mat-button-toggle-group>
            </span>
        </div>
        <div formGroupName="filters" class="filters-form" >
            <div class="settings-row equal-flex" *ngIf="settings?.displayFilterOptions === true">
                <mat-form-field appearance="outline">
                    <mat-label>Title</mat-label>
                    <input matInput placeholder="Title" formControlName="title">
                    <button mat-icon-button matSuffix color="warn"><mat-icon>clear</mat-icon></button>
                    <mat-hint>Title contains this text.</mat-hint>
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>Description</mat-label>
                    <input matInput placeholder="Description" formControlName="description">
                    <button mat-icon-button matSuffix color="warn"><mat-icon>clear</mat-icon></button>
                    <mat-hint>Description contains this text.</mat-hint>
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>After</mat-label>
                    <input matInput [matDatepicker]="afterDate" formControlName="after">
                    <button mat-icon-button matSuffix color="warn"><mat-icon>clear</mat-icon></button>
                    <mat-hint>Posted after this date.</mat-hint>
                    <mat-datepicker-toggle matIconSuffix [for]="afterDate"></mat-datepicker-toggle>
                    <mat-datepicker #afterDate>
                        <mat-datepicker-actions>
                            <button mat-button matDatepickerCancel>Cancel</button>
                            <button mat-raised-button color="primary" matDatepickerApply>Apply</button>
                        </mat-datepicker-actions>
                    </mat-datepicker>
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>Before</mat-label>
                    <input matInput [matDatepicker]="beforeDate" formControlName="before">
                    <button mat-icon-button matSuffix color="warn"><mat-icon>clear</mat-icon></button>
                    <mat-hint>Posted before this date.</mat-hint>
                    <mat-datepicker-toggle matIconSuffix [for]="beforeDate"></mat-datepicker-toggle>
                    <mat-datepicker #beforeDate>
                        <mat-datepicker-actions>
                            <button mat-button matDatepickerCancel>Cancel</button>
                            <button mat-raised-button color="primary" matDatepickerApply>Apply</button>
                        </mat-datepicker-actions>
                    </mat-datepicker>
                </mat-form-field>
            </div>
            <div class="settings-row equal-flex" *ngIf="settings?.displayAuthorOptions === true">
                <mat-form-field appearance="outline">
                    <mat-label>Authors Included</mat-label>
                    <mat-chip-grid #authorsIncludesGrid>
                        <mat-chip-row color="warn" *ngFor="let authorId of settings?.filterAuthorsInclude; let i = index"
                            (removed)="removeIncludedAuthor(authors![authorId])">
                            {{authors ? authors![authorId].displayName : ''}}
                            <button matChipRemove>
                                <mat-icon>cancel</mat-icon>
                            </button>
                        </mat-chip-row>
                    </mat-chip-grid>
                    <mat-icon color="primary" matPrefix>add_task</mat-icon>
                    <input [matChipInputFor]="authorsIncludesGrid" [matAutocomplete]="authorsAuto"
                        [formControl]="includedAuthorsControl" />
                    <mat-autocomplete #authorsAuto="matAutocomplete"
                        (optionSelected)="addIncludedAuthor($event.option.value)">
                        <mat-option *ngFor="let author of (filteredIncludedAuthors | async)" [value]="author">
                            {{author.displayName}}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>Any of these authors.</mat-hint>
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>Authors Excluded</mat-label>
                    <mat-chip-grid #authorsExcludeGrid>
                        <mat-chip-row *ngFor="let authorId of settings?.filterAuthorsExclude; let i = index"
                            (removed)="removeExcludedAuthor(authors![authorId])">
                            {{authors ? authors![authorId].displayName : ''}}
                            <button matChipRemove>
                                <mat-icon>cancel</mat-icon>
                            </button>
                        </mat-chip-row>
                    </mat-chip-grid>
                    <mat-icon color="warn" matPrefix>block</mat-icon>
                    <input [matChipInputFor]="authorsExcludeGrid" [matAutocomplete]="authorsExcludedOptions"
                    [formControl]="excludedAuthorsControl" />
                    <mat-autocomplete #authorsExcludedOptions="matAutocomplete"
                        (optionSelected)="addExcludedAuthor($event.option.value)">
                        <mat-option *ngFor="let author of (filteredExcludedAuthors | async)" [value]="author">
                            {{author.displayName}}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>None of these authors.</mat-hint>
                </mat-form-field>
            </div>
            <div class="settings-row equal-flex" *ngIf="settings?.displayTagOptions === true">
                <mat-form-field appearance="outline">
                    <mat-label>Tags Included</mat-label>
                    <mat-chip-grid #tagsIncludeGrid>
                        <mat-chip-row color="warn" *ngFor="let tag of settings?.filterTagsInclude; let i = index"
                            (removed)="removeIncludedTag(tag)">
                            {{tag}}
                            <button matChipRemove>
                                <mat-icon>cancel</mat-icon>
                            </button>
                        </mat-chip-row>
                    </mat-chip-grid>
                    <mat-icon color="primary" matPrefix>add_task</mat-icon>
                    <input [matChipInputFor]="tagsIncludeGrid" [matAutocomplete]="tagsIncludedOptions"
                        [formControl]="includedTagsControl" />
                    <mat-autocomplete #tagsIncludedOptions="matAutocomplete"
                        (optionSelected)="addIncludedTag($event.option.value)">
                        <mat-option *ngFor="let tag of (filteredIncludedTags | async)" [value]="tag">
                            {{tag}}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>All of these tags.</mat-hint>
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>Tags Excluded</mat-label>
                    <mat-chip-grid #tagsExcludeGrid>
                        <mat-chip-row *ngFor="let tag of settings?.filterTagsExclude; let i = index"
                            (removed)="removeExcludedTag(tag)">
                            {{tag}}
                            <button matChipRemove>
                                <mat-icon>cancel</mat-icon>
                            </button>
                        </mat-chip-row>
                    </mat-chip-grid>
                    <mat-icon color="warn" matPrefix>block</mat-icon>
                    <input [matChipInputFor]="tagsExcludeGrid" [matAutocomplete]="tagsExcludedOptions"
                        [formControl]="excludedTagsControl" />
                    <mat-autocomplete #tagsExcludedOptions="matAutocomplete"
                        (optionSelected)="addExcludedTag($event.option.value)">
                        <mat-option *ngFor="let tag of (filteredExcludedTags | async)" [value]="tag">
                            {{tag}}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>None of these tags.</mat-hint>
                </mat-form-field>
            </div>
        </div>
        <div class="settings-row" *ngIf="settings?.displayResetButtons === true">
            <button mat-raised-button color="warn" (click)="clearFilters()"><mat-icon>clear</mat-icon>Clear
                Filters</button>
            <button (click)="restoreDefaults()" mat-raised-button color="accent">
                <mat-icon>settings_backup_restore</mat-icon>
                Restore Defaults</button>
        </div>
    </div>
</div>